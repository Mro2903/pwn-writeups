#!/usr/bin/env python
from pwn import *
import os

args = [b'\x00']*100
args[ord('B')] = '\x20\x0a\x0d'
args[ord('C')] = '12345'

r1, w1 = os.pipe()
r2, w2 = os.pipe()
os.write(w1, b'\x00\x0a\x00\xff')
os.write(w2, b'\x00\x0a\x02\xff')

with open('\x0a', 'wb') as f:
	f.write(b'\x00\x00\x00\x00')

p = process(executable='input2', 
	    argv=args, 
	    stdin=r1, stderr=r2, 
	    env={'\xde\xad\xbe\xef' :'\xca\xfe\xba\xbe'})

conn = remote('localhost', 12345)
conn.sendline('\xde\xad\xbe\xef')

result = p.recvall()
p.close()
conn.close()
print(result.decode('utf-8'))